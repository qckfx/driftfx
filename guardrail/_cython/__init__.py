# Cython optimized functions for guardrail